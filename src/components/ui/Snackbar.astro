---
// src/components/ui/Snackbar.astro
/**
 * Material Design 3 Snackbar Component
 */

export interface Props {
  id: string;
  message: string;
  action?: string;
  duration?: number;
  class?: string;
}

const {
  id,
  message,
  action,
  duration = 4000,
  class: className = '',
} = Astro.props;

import Button from './Button.astro';
---

<div
  class:list={['snackbar', className]}
  id={id}
  role="status"
  aria-live="polite"
  data-duration={duration}
>
  <div class="snackbar-content">
    <span class="snackbar-message">{message}</span>
    {action && (
      <Button variant="text" class="snackbar-action">
        {action}
      </Button>
    )}
  </div>
</div>

<style>
  .snackbar {
    position: fixed;
    bottom: 16px;
    left: 50%;
    transform: translateX(-50%) translateY(100px);
    min-width: 344px;
    max-width: 672px;
    background-color: var(--md-sys-color-inverse-surface);
    color: var(--md-sys-color-inverse-on-surface);
    border-radius: 4px;
    box-shadow: 0 3px 5px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    opacity: 0;
    transition: all 300ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .snackbar.active {
    transform: translateX(-50%) translateY(0);
    opacity: 1;
  }

  .snackbar-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
    padding: 14px 16px;
  }

  .snackbar-message {
    font-family: var(--md-sys-typescale-body-medium-font);
    font-size: var(--md-sys-typescale-body-medium-size);
    font-weight: var(--md-sys-typescale-body-medium-weight);
    flex: 1;
  }

  .snackbar-action {
    color: var(--md-sys-color-inverse-primary);
  }

  @media (max-width: 600px) {
    .snackbar {
      left: 16px;
      right: 16px;
      transform: translateY(100px);
      min-width: auto;
    }

    .snackbar.active {
      transform: translateY(0);
    }
  }
</style>

<script>
  document.querySelectorAll('.snackbar').forEach(snackbar => {
    const duration = parseInt(snackbar.getAttribute('data-duration') || '4000');

    function show() {
      snackbar.classList.add('active');

      setTimeout(() => {
        hide();
      }, duration);
    }

    function hide() {
      snackbar.classList.remove('active');
    }

    // Auto-show if already active
    if (snackbar.classList.contains('active')) {
      setTimeout(() => hide(), duration);
    }
  });
</script>
